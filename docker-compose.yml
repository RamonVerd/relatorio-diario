version: '3.8'

services:
  app:
    build: .
    container_name: java_app
    ports:
      - "8080:8080"
    depends_on:
      - postgres
    environment:                   
      - SPRING_DATASOURCE_URL=jdbc:mysql://localhost/relatorio?createDataBaseIfNotExist=true&serverTimezone=UTC
      #- SPRING_DATASOURCE_URL=jdbc:postgresql://relatorio-diario_owner:npg_dVtxEqTUz52D@ep-polished-darkness-a8jtfdqu-pooler.eastus2.azure.neon.tech/relatorio-diario?sslmode=require
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=12345
      - SPRING_JPA_HIBERNATE_DDL_AUTO=update
      - SPRING_JPA_SHOW_SQL=true
    networks:
      - minha-rede

  mysql:
  image: mysql:8.0
  container_name: mysql_db
  restart: always
  environment:
    MYSQL_DATABASE: relatorio
    MYSQL_USER: root
    MYSQL_PASSWORD: 12345
    MYSQL_ROOT_PASSWORD: 12345
  ports:
    - "3306:3306"
  volumes:
    - mysql_data:/var/lib/mysql

volumes:
  mysql_data:


networks:
  minha-rede:
